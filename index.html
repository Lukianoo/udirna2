<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<title>Udírna – přehledný dashboard</title>
<style>
body{
  margin:0;
  background:#000;
  color:#fff;
  font-family:Arial,Helvetica,sans-serif;
}
.wrap{
  display:flex;
  gap:30px;
  justify-content:center;
  padding:30px;
}
.card{
  background:#0b0b0b;
  border-radius:20px;
  padding:20px;
  box-shadow:0 0 30px rgba(255,120,0,.3);
  text-align:center;
}
svg{width:260px;height:260px}
.label{margin-top:10px;color:#ccc}
input{width:100%;margin:6px 0;padding:6px;border-radius:6px}
button{padding:6px 10px;border-radius:6px}
</style>
</head>
<body>

<div class="wrap">
  <div class="card">
    <svg id="gHum"></svg>
    <div class="label">Vlhkost (%)</div>
  </div>

  <div class="card">
    <svg id="gMain"></svg>
    <div class="label">Teplota udírny (°C)</div>
    <input id="minA" type="number" value="75">
    <input id="maxA" type="number" value="85">
    <label><input type="checkbox" id="sound" checked> Zvuk alarmu</label><br>
    <button onclick="unlockAudio();beep(400)">Test zvuku</button>
  </div>

  <div class="card">
    <svg id="gOut"></svg>
    <div class="label">Teplota venku (°C)</div>
  </div>
</div>

<script>
/* ===== GAUGE ===== */
class Gauge{
  constructor(svg,{min,max,unit,arc=false}){
    this.svg=svg;this.min=min;this.max=max;this.unit=unit;this.arcEnabled=arc;
    svg.setAttribute('viewBox','0 0 200 200');
    svg.innerHTML=`
      <circle cx="100" cy="100" r="90" fill="#111"/>
      <g class="scale"></g>
      ${arc?'<path class="arc" stroke="#1e90ff" stroke-width="12" fill="none"/>':''}
      <line class="needle" x1="100" y1="100" x2="100" y2="25" stroke="#fff" stroke-width="4"/>
      <text class="val" x="100" y="120" font-size="36" text-anchor="middle">0</text>
      <text x="100" y="145" font-size="16" fill="#aaa" text-anchor="middle">${unit}</text>`;

    this.scale=svg.querySelector('.scale');
    this.arc=svg.querySelector('.arc');
    this.needle=svg.querySelector('.needle');
    this.valText=svg.querySelector('.val');

    this.drawScale();
    this.set(min);
  }

  angle(v){return (v-this.min)/(this.max-this.min)*180-90}
  polar(v,r){const a=this.angle(v)*Math.PI/180;return[100+r*Math.cos(a),100+r*Math.sin(a)]}

  drawScale(){
    for(let i=0;i<=10;i++){
      const v=this.min+(this.max-this.min)/10*i;
      const [x1,y1]=this.polar(v,70);
      const [x2,y2]=this.polar(v,85);
      this.scale.innerHTML+=`<line x1="${x1}" y1="${y1}" x2="${x2}" y2="${y2}" stroke="#555"/>`;
    }
  }

  set(v){
    v=Math.max(this.min,Math.min(this.max,v));
    this.valText.textContent=v.toFixed(1);
    this.needle.setAttribute('transform',`rotate(${this.angle(v)} 100 100)`);
    if(this.arc){
      const [x0,y0]=this.polar(this.min,80);
      const [x1,y1]=this.polar(v,80);
      const large=v>this.min+(this.max-this.min)/2?1:0;
      this.arc.setAttribute('d',`M ${x0} ${y0} A 80 80 0 ${large} 1 ${x1} ${y1}`);
    }
  }
}

/* ===== AUDIO ===== */
let audioCtx=null;
function unlockAudio(){ if(!audioCtx) audioCtx=new (window.AudioContext||window.webkitAudioContext)(); }
function beep(f){ if(!audioCtx||!sound.checked)return; const o=audioCtx.createOscillator();const g=audioCtx.createGain();o.frequency.value=f;o.connect(g);g.connect(audioCtx.destination);g.gain.setValueAtTime(0.2,audioCtx.currentTime);g.gain.exponentialRampToValueAtTime(0.001,audioCtx.currentTime+0.2);o.start();o.stop(audioCtx.currentTime+0.2);} 

/* ===== INIT ===== */
const hum=new Gauge(gHum,{min:0,max:100,unit:'%'});
const main=new Gauge(gMain,{min:0,max:120,unit:'°C',arc:true});
const out=new Gauge(gOut,{min:-30,max:50,unit:'°C'});

let t=18;
setInterval(()=>{
  t+=Math.random()*2-1;
  main.set(t);
  if(t<minA.value||t>maxA.value)beep(800);
},2000);
</script>
</body>
</html>
